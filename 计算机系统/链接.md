

### 编译器驱动程序（compiler driver）

###### gcc (GNU Compiler Collection)

* 简介：是由GNU开发的编程器。GCC的初衷是为GNU操作系统专门编写的一款编译器。GCC原名为GNU C语言编译器（GNU C Compiler），只能处理C语言。但其很快扩展，变得可处理C++，后来又扩展为能够支持更多编程语言，如Fortran、Pascal、Objective -C、Java、Ada、Go以及各类处理器架构上的汇编语言等，所以改名GNU编译器套件（GNU Compiler Collection） [1]  。

* gcc是 c语言的编译器，使用gcc由c语言`源代码文件`， `生成可执行文件的过程`。
    * 编译过程：
        * 预处理(preprocessing) :预处理器
        * 编译(compilation)：编译器
        * 汇编(assembly)：汇编器
        * 链接(linking)：链接器

    * 命令gcc首先`调用cpp进行预处理`，在预处理过程中，对源代码文件中文件 包含(include)/预编译语句（如宏定义 define等）进行分析。
    * 接着`调用cc1进行编译`，这个阶段根据输入文件生成`以.i为后缀的目标文件`。
    * 汇编过程是针对汇编语言的步骤，`调用as`进行工作。一般`.S为后缀的汇编语言源代码文件和汇编`、`.s为后缀的汇编语言文件`经过预编译和汇编之后都生成以.o为后缀的目标文件。
    * 当所有的目标文件都生成之后，gcc就`调用ld`来完成最后的关键性工作，这个阶段就是连接。在连接阶段，所有的目标文件被安排在可执行程序中的恰当的位置，同时，该程序所调用到的库函数也从各自所在的档案库中连到合适的地方。



* 用法 -- GCC最基本的用法是∶gcc [options] [filenames]
    * 其中options就是编译器所需要的参数，filenames给出相关的文件名称。
        * -c : `只编译，不链接成可执行文件`，编译器只是由输入的`.c`等源代码文件生成`.o `为后缀的目标文件，通常用于编译不包含主程序的子程序文件。
        * -o output_filename，确定输出文件的名称为output_filename，同时这个名称不能和源文件同名。如果不给出这个选项，gcc就给出预设的可执行文件a.out。
        * -g，产生符号调试工具（GNU的gdb）所必要的符号资讯，要想对源代码进行调试，我们就必须加入这个选项。
        * -O，对程序进行优化编译、链接，采用这个选项，整个源代码会在编译、链接过程中进行优化处理，这样产生的可执行文件的执行效率可以提高，但是，编译、链接的速度就相应地要慢一些。
        * -O2，比-O更好的优化编译、链接，当然整个编译、链接过程会更慢。

* gcc所遵循的部分约定规则：
    * .c为后缀的文件，C语言源代码文件；
    * .h为后缀的文件，是程序所包含的头文件；
    * .m为后缀的文件，是Objective-C源代码文件；
    * .s为后缀的文件，是汇编语言源代码文件；
    * .o为后缀的文件，是编译后的目标文件；




### 静态链接 -- static linker
* 概念:
    * 以一组`可重定位目标文件` 和 `命令行参数`作为输入，生成一个`完全链接`的、可以`加载和运行`的`可执行目标文件` 作为 输出。

    * 输入的可重定位目标文件由 各种不同的代码 和 数据节（section）组成，每一节都是一个连续的字节序列。指令在一节中，初始化了的全局变量在另一节中，而未初始化的变量又在另外一节中。

* 为了`构造可执行文件`，`链接器`必须完成两个主要任务： 
    * 符号解析（symbol resolution）。
        目标文件定义和引用符号，每个符号对应于一个函数、一个全局变量或一个静态变量（即 C 语言中任何以 static 属性声明的变量）。符号解析的目的是将每个符号引用正好和一个符号定义关联起来。

    * 重定位（relocation）。
        重定位（relocation）。编译器和汇编器生成从地址 0 开始的代码和数据节。链接器通过把每个符号定义与一个内存位置关联起来，从而重定位这些节，然后修改所有对这些符号的引用，使得它们指向这个内存位置。链接器使用汇编器产生的重定位条目（relocation entry）的详细指令，不加甄别地执行这样的重定位。

关于链接器的一些基本事实：`目标文件纯粹是字节块的集合`。这些块中，有些包含程序代码，有些包含程序数据，而其他的则包含引导链接器和加载器的数据结构。链接器将这些块连接起来，确定被连接块的运行时位置，并且修改代码和数据块中的各种位置。链接器对目标机器了解甚少。产生目标文件的编译器和汇编器已经完成了大部分工作。


### 目标文件


### 链接


从传统静态链接到加载时的共享库的动态链接，以及到运行时的共享库的动态链接

##### 链接是如何工作的


编译系统 -- 提供 编译器 驱动程序，在需要时调用语言预处理器、编译器、汇编器和链接器；


### 其他知识
* 可执行文件 (executable file) 指的是可以由操作系统进行加载执行的文件。
* 在不同的操作系统环境下，可执行程序的呈现方式不一样。
* 在windows操作系统下，可执行程序可以是 .exe文件 .sys文件 .com等类型文件。

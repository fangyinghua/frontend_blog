# TCP

### IP (根据IP地址穿越网络传送数据；(地址的管理、路由的选择（跨越很多网络设备）))

* 主要解决了什么问题
1. 地址管理：
【网络上的这些主机和节点都需要使用一种规则来区分，就相当于是一种身份标识】
  * 地址管理解决方案
    每一个主机都会有一个身份标识，这个标识是由32位数字组成的，但是现在连接网络的设备太多了，光靠这32位已经没有办法分配了，于是就有了一下解决方案：
    1. 动态分配IP地址：
    【只有`联网了才给分配`，不联网的时候就不分配（这种方法在一定程度上可以说是解决了问题，但是治标不治本）】
    2. NAT机制：
    【网络地址转换，也就是`允许局域网内部的IP地址重复`，使用一个IP来表示一批局域网内部的设备，这样的地址转换过程一般是由路由器来负责的，但是只允许局域网之间有重复的IP，广域网上的IP仍然是不能重复的，NAT可以用一个外网IP来表示一系列的内部网络设备】
    3. IPV6
    【这是从根本上解决了IP不够用的问题，IP地址很长，有16个字节（128位），但是与IPV4不兼容】

2. 路由选择：
【从主机A传输到主机B，由于A和B需要跨越很多网络设备，数据在传输过程中需要选择路径】

3. IP头部
    * Source Address（源地址）
    * Destination Address


### TCP历史
* TCP/IP 的前身 ARPA：NCP协议
* 1973年 TCP v1，包括IP功能的TCP协议
* 1997 TCPv2
* 1978 TCPv3
* 1980(分层) TCPv4（1981.9 RFC783） + IPv4
* IP协议解决跨域不同的网络传递消息
* TCP解决任意长度消息的可靠传输 （丢包 / 容错）
* IP必须支持不同的通信设备（不同路由器等）；
* IP连接不同种类的网络(wifi)

### 解决了什么问题？
* 任意长度消息的可靠传输
* TCP:面向连接的、可靠的、基于字节流(有顺/无边界)的传输层通信协议；
* 层层嵌套`报文头部` (TCP头部)
* 报文头部的`层层组装与卸载`

* TCP协议特点
    * 在IP协议之上，解决网络通讯可依赖问题
        * 点对点(不能广播、多播)，面向连接
        * 双向传递（全双工）
        * 字节流：打包成`报文段`、保证有序接收、重复报文自动丢弃
            * 缺点：不维护 应用 报文的边界(对比 http --自己通过\r\n表示结尾；content-length：定义body的结尾);
            * 优点：不强制要求应用 必须离散的创建数据块，不限制数据大小;
        * 流量缓冲：解决速度不匹配问题;
        * 可靠的传输服务（保证可达，丢包时通过`重发`进而`增加时延`实现可靠性）;
        * 拥塞控制（双方网络问题）;
        
### TCP头部

1. UDP头部 （进程）
    * Source Port / Destination Port
    * Length / Checksum

2. TCP协议的任务
    * 主机内的进程寻址
    * 创建、管理、终止连接
    * 处理并将`字节流`打包成`报文段`(如：IP报文)
    * 传输数据
    * 保持可靠性与传输质量
    * 流控制与拥塞控制

3. 如何标识一个连接？
    * TCP四元组(源地址、源端口、目的地址、目的端口)
        * 对于IPv4地址，单主机最大TCP连接数为2^(32+16+3+16);
    * 没有连接ID：QUIC协议
4. TCP segment报文段（常规报文20个字节）

### TCP 握手过程
* 握手目标
    * 同步 Sequence序列号
        * 初始序列号 ISN（initial Sequence Number）
    * 交互TCP通信参数
        * 如 MSS 、窗口比例因子 、选择性确认、指定校验和算法

### 流量控制（滑动窗口）

### TCP 怎么保证可靠传输

### 滑动窗口的大小那一端控制？server 为什么要控制？client 为什么要控制？


### 拥塞控制
